# 🚗 장기 방치 차량 탐지 시스템 - 최종 설정 가이드

## ✨ 시스템 개요

**국토정보플랫폼 API**를 연동하여 실제 항공사진으로 장기 방치 차량을 탐지하는 웹 시스템

### 주요 기능
- 📍 **주소 기반 검색** (시/도/동/지번 드롭다운)
- 🗺️ **실시간 지도 이동**
- 🔵 **파란색 마커**로 방치 차량 표시
- 🖼️ **위성사진 팝업** (차량 클릭 시)
- ⚫⚪ **심플한 흑백 디자인**
- 🔄 **1회 분석 + 업데이트** 버튼

---

## 📋 사전 준비물

1. ✅ Python 3.8+ 설치
2. ✅ Node.js 18+ 설치
3. ✅ Poppler 설치 (`brew install poppler`)
4. ✅ **국토정보플랫폼 API 키** 발급 ← **가장 중요!**

---

## 🔑 API 키 발급 방법

### 1단계: 국토정보플랫폼 가입
1. https://www.vworld.kr 접속
2. 회원가입 및 로그인

### 2단계: API 신청
1. 상단 메뉴 **"오픈API"** 클릭
2. **"오픈 API 활용신청"** 클릭
3. 신청 양식 작성:
   ```
   서비스명: 장기 방치 차량 탐지 시스템
   서비스 URL: http://localhost:3000
   서비스 설명: 항공사진 기반 장기 방치 차량 탐지
   ```
4. 신청 완료 (보통 즉시 승인)

### 3단계: API 키 확인
1. "마이페이지" → "오픈API 관리"
2. API 인증키(KEY) 복사
3. 형식 예시: `12345678-ABCD-1234-EFGH-123456789ABC`

---

## ⚙️ 시스템 설정

### 1️⃣ API 키 입력 **(필수!)**

프로젝트 폴더의 **`.env`** 파일을 열어서:

```bash
# 이 부분을 찾아서
NGII_API_KEY=여기에_발급받은_API_키를_입력하세요

# 실제 발급받은 키로 변경
NGII_API_KEY=12345678-ABCD-1234-EFGH-123456789ABC
```

### 2️⃣ 의존성 설치

```bash
# 프로젝트 루트에서
npm run install:all

# 또는 개별 설치
cd backend && pip install -r requirements.txt
cd frontend && npm install
```

### 3️⃣ API 연동 테스트

```bash
cd backend
python ngii_api_service.py
```

**성공 시:**
```
✓ 주소 검색 성공!
  주소: 제주특별자치도 제주시 일도이동 923
  위도: 33.5102
  경도: 126.5219
```

**실패 시:** API 키를 다시 확인하세요!

---

## 🚀 실행 방법

### 방법 1: 개발 모드 (권장)

**Terminal 1 - 백엔드:**
```bash
cd backend
python fastapi_app.py
```
→ http://localhost:8000 에서 실행

**Terminal 2 - 프론트엔드:**
```bash
cd frontend
npm start
```
→ http://localhost:3000 에서 실행

### 방법 2: 통합 실행

```bash
npm run dev
```

---

## 💻 사용 방법

### 1️⃣ 주소 검색
1. 브라우저에서 http://localhost:3000 접속
2. 상단 중앙의 드롭다운에서 주소 선택:
   - **시/도**: 제주특별자치도
   - **시/군/구**: 제주시
   - **동/읍/면**: 일도이동
   - **지번**: 923
3. **"위치 검색"** 버튼 클릭
4. 지도가 해당 위치로 이동

### 2️⃣ 방치 차량 분석
1. **"방치 차량 분석"** 버튼 클릭
2. 분석 중... (수 분 소요)
3. 결과 확인:
   - 🔵 **파란색 마커**: 방치 차량 위치
   - 우측 하단 통계: 발견된 차량 수

### 3️⃣ 차량 상세 확인
1. 지도의 파란색 마커 클릭
2. 팝업 창에서 **"상세보기"** 클릭
3. 차량 정보 + 위성사진 확인:
   - 유사도
   - 위험도
   - 경과 시간
   - 위치 좌표

### 4️⃣ 분석 업데이트
- 분석 완료 후 **"업데이트"** 버튼으로 재분석 가능

---

## 🎨 UI 특징

### 디자인 컨셉
- ⚫⚪ **흑백 테마**: 심플하고 깔끔한 인터페이스
- 🔵 **파란색 강조**: 방치 차량만 파란색으로 표시
- 📍 **중앙 집중**: 검색 바가 화면 상단 중앙

### 레이아웃
```
┌─────────────────────────────────────┐
│   장기 방치 차량 탐지 시스템         │
│  [시/도][시/군/구][동][지번][검색][분석]  │
└─────────────────────────────────────┘
┌─────────────────────────────────────┐
│                                     │
│          지도 영역                   │
│     (파란색 마커 = 방치 차량)         │
│                                     │
│                          [통계]     │
└─────────────────────────────────────┘
```

### 색상 가이드
- **배경**: 검은색 (#000000)
- **컨트롤**: 회색 (#1a1a1a)
- **텍스트**: 흰색 (#ffffff)
- **방치 차량**: 파란색 (#3B82F6)
- **정상**: 초록색 (#10B981)

---

## 📁 주요 파일 구조

```
satellite_project/
├── .env                              ← API 키 여기에 입력!
├── API_SETUP_GUIDE.md               ← 상세 API 가이드
├── QUICK_API_SETUP.md               ← 빠른 시작 가이드
├── backend/
│   ├── ngii_api_service.py          ← 국토정보플랫폼 API 연동
│   ├── fastapi_app.py               ← FastAPI 서버
│   ├── abandoned_vehicle_detector.py ← ResNet 탐지 엔진
│   └── pdf_processor.py             ← 이미지 처리
├── frontend/
│   └── src/components/
│       └── MainDetectionPage.tsx    ← 새로운 메인 페이지
├── sample_image1.pdf                ← 2015년 샘플
└── sample_image2.pdf                ← 2020년 샘플
```

---

## 🔧 문제 해결

### 문제 1: "API 키가 설정되지 않았습니다"
**해결:** `.env` 파일에서 `NGII_API_KEY` 값 확인

### 문제 2: "주소를 찾을 수 없습니다"
**해결:** API 키가 유효한지 확인 (vworld.kr → 마이페이지)

### 문제 3: 지도가 움직이지 않음
**해결:**
1. 콘솔 오류 확인 (F12)
2. 백엔드 서버 실행 확인
3. API 키 재확인

### 문제 4: 방치 차량이 표시되지 않음
**원인:** 샘플 데이터 사용 중
**해결:** 실제 항공사진 데이터 필요 또는 샘플 이미지로 테스트

---

## 📊 샘플 데이터 테스트

실제 항공사진 없이 테스트하려면:

```bash
python test_abandoned_detection.py
```

샘플 결과:
- 2015년 vs 2020년 제주시 일도이동 비교
- 방치 차량 3대 발견
- `comparison_result.jpg` 생성

---

## 🎯 다음 단계

### 단기 (현재 가능)
- [x] 주소 기반 검색
- [x] 지도 표시
- [x] 파란색 마커
- [x] 상세 팝업

### 중기 (개발 필요)
- [ ] 실제 항공사진 다운로드 연동
- [ ] 자동 주차 공간 탐지
- [ ] 다년도 비교 (2015→2020)

### 장기 (운영 준비)
- [ ] 관리자 대시보드
- [ ] 알림 시스템
- [ ] 데이터베이스 최적화
- [ ] 클라우드 배포

---

## 📞 지원

### 문서
- [API_SETUP_GUIDE.md](API_SETUP_GUIDE.md) - 상세 API 가이드
- [CLAUDE.md](CLAUDE.md) - 개발자 가이드
- [README_ABANDONED_DETECTION.md](README_ABANDONED_DETECTION.md) - 시스템 설명

### 국토정보플랫폼 고객센터
- 전화: 1588-7906
- 이메일: support@vworld.kr
- 웹사이트: https://www.vworld.kr

---

## ✅ 최종 체크리스트

시작 전 확인:

- [ ] Python 3.8+ 설치됨
- [ ] Node.js 18+ 설치됨
- [ ] Poppler 설치됨 (`brew install poppler`)
- [ ] 국토정보플랫폼 회원가입 완료
- [ ] API 키 발급 받음
- [ ] `.env` 파일에 API 키 입력함
- [ ] `python ngii_api_service.py` 테스트 성공
- [ ] `npm run install:all` 실행 완료
- [ ] FastAPI 서버 시작됨 (port 8000)
- [ ] Frontend 서버 시작됨 (port 3000)
- [ ] 브라우저에서 http://localhost:3000 접속 가능

**모두 체크되면 시스템 사용 준비 완료!** 🎉

---

**작성일:** 2025-10-23
**버전:** 2.0.0
**시스템:** 장기 방치 차량 탐지 시스템
**상태:** 실전 배포 준비
